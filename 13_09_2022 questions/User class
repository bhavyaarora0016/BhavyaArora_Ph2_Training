using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using MoviesLib;
using static MoviesLib.UserClass;

namespace MoviesLib
{
    public class UserClass
    {
        public int moviesBorrowed = 0;
        public enum UserLevel
        {
            Platinum = 5,
            Gold = 3,
            Silver = 2
        }

        public List<MovieClass> borrowedMovies;
        public UserClass()
        {
            this.userlevel = (int)UserLevel.Silver;
            borrowedMovies = new List<MovieClass>();

        }

        private int _userlevel;

        public int userlevel
        {
            get { return _userlevel; }
            set { _userlevel = value; }
        }

        private string _username;

        public string username
        {
            get { return _username; }
            set { _username = value; }
        }

        private string _password;

        public string password
        {
            get { return _password; }
            set { _password = value; }
        }

        public UserClass(string username, string password, string userlevel1)
        {
            if (userlevel1 == "Platinum")
            {
                this.userlevel = (int)UserLevel.Platinum;
            }

            if (userlevel1 == "Gold")
            {
                this.userlevel = (int)UserLevel.Gold;
            }

            if (userlevel1 == "Silver")
            {
                this.userlevel = (int)UserLevel.Silver;
            }

            this.username = username;
            this.password = password;

        }

        public void AddUser(string username, string password, string userlevel1)
        {
            if (userlevel1 == "Platinum")
            {
                this.userlevel = (int)UserLevel.Platinum;
            }

            if (userlevel1 == "Gold")
            {
                this.userlevel = (int)UserLevel.Gold;
            }

            if (userlevel1 == "Silver")
            {
                this.userlevel = (int)UserLevel.Silver;
            }

            this.username = username;
            this.password = password;

        }

        public void BorrowMovie(MovieClass m)
        {
            if (m.Availability>0)
            {
                if (this.moviesBorrowed <= this.userlevel)
                {
                    m.Availability--;
                    this.moviesBorrowed++;
                    borrowedMovies.Add(m);
                }
                else
                {
                    Console.WriteLine("user can't borrow more movies");
                }
            }
            else
            {
                Console.WriteLine("movie not available");
            }
        }

        public void ReturnMovie(MovieClass m, int days)
        {
            if (this.borrowedMovies.Contains(m))
            {
                m.Availability++;
                this.moviesBorrowed--;
                borrowedMovies.Remove(m);

                double totalCost = days * m.Cost;
                Console.WriteLine("amount : {0}" , totalCost);

            }
            else
            {
                Console.WriteLine("didn't borrowed this movie.");
            }
        }

        public void SearchByLanguage(string language)
        {
            foreach (var item in MovieClass.MoviesList)
            {
                if (item.Language == language)
                {
                    Console.WriteLine($"Movie Name : {item.movieName}  Language : {item.Language} Genere : {item.Genre}");
                }
            }
        }
        public void SearchByGenre(string genre)
        {
            foreach (var item in MovieClass.MoviesList)
            {
                if (item.Genre == genre)
                {
                    Console.WriteLine($"Movie Name : {item.movieName}  Language : {item.Language} Genere : {item.Genre}");
                }
            }
        }

        public void ShowMyList()
        {
            foreach (var item in this.borrowedMovies)
            {
                Console.WriteLine($"Movie Name : {item.movieName}  Language : {item.Language} Genere : {item.Genre}");
            }
        }

    }
}
